<!doctype html>
<html lang="en-US">
  <head prefix="og: https://ogp.me/ns#">
    <meta charset="utf-8" />
    <meta name="generator" content="gh:importantimport/urara" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="manifest" crossorigin="use-credentials" href="/manifest.webmanifest" />
    <link rel="alternate" type="application/feed+json" href="/feed.json" />
    <link rel="alternate" type="application/atom+xml" href="/atom.xml" />
    <link rel="sitemap" type="application/xml" href="/sitemap.xml" />
    <meta http-equiv="content-security-policy" content="style-src 'self' 'unsafe-inline' https://giscus.app">
		<link href="../../_app/immutable/assets/0.CWRPPIgm.css" rel="stylesheet">
		<link href="../../_app/immutable/assets/posts.D4gQgZwN.css" rel="stylesheet">
		<link rel="modulepreload" href="../../_app/immutable/entry/start.vDsreik-.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/entry.DjDlR3mZ.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/scheduler.FGUOCI5T.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.BI7v63FY.js">
		<link rel="modulepreload" href="../../_app/immutable/entry/app.6eKRZCuF.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/preload-helper.BQ24v_F8.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/index.TPYxZWDS.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/0.DftcSboB.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/posts.4dVmwM_k.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/icon.cz6pXhqM.js">
		<link rel="modulepreload" href="../../_app/immutable/nodes/3.DNi17blR.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/post_layout.DZUhCZ7m.js">
		<link rel="modulepreload" href="../../_app/immutable/chunks/footer.BUtXrnWl.js"><title>Akasec CTF 2024 writeup | AkaniX3</title><!-- HEAD_svelte-1592q3p_START --><!-- HEAD_svelte-1592q3p_END --><!-- HEAD_svelte-1kxdj3d_START --><link rel="shortcut icon" href="https://urara-demo.netlify.app/favicon.png" sizes="48x48" type="image/png"><link rel="apple-touch-icon" href="https://urara-demo.netlify.app/assets/any@180.png" sizes="180x180" type="image/png"><link rel="icon" href="https://urara-demo.netlify.app/assets/any@192.png" sizes="192x192" type="image/png"><!-- HEAD_svelte-1kxdj3d_END --><!-- HEAD_svelte-1g590ms_START --><meta name="theme-color"><!-- HEAD_svelte-1g590ms_END --><!-- HEAD_svelte-abrfj_START --><meta name="author" content="AkaniX3"><link rel="canonical" href="https://urara-demo.netlify.app/blogs/akasec_CTF_2024">  <meta name="keywords" content="CTF, Cryptography"> <!-- HEAD_svelte-abrfj_END --><!-- HEAD_svelte-4dky5b_START --><meta property="og:site_name" content="AkaniX3"><meta property="og:locale" content="en-US"><meta property="og:type" content="article"> <meta property="og:title" content="Akasec CTF 2024 writeup">  <meta property="og:image" content="https://urara-demo.netlify.app/blogs/akasec_CTF_2024/akasec1.png"> <meta name="twitter:card" content="summary_large_image"> <meta property="article:tag" content="CTF"><meta property="article:tag" content="Cryptography"> <meta property="og:url" content="https://urara-demo.netlify.app/blogs/akasec_CTF_2024"> <meta property="article:author" content="AkaniX3"> <meta property="article:published_time" content="2024-6-11"> <meta property="article:modified_time" content="2024-06-18T04:52:25.531Z"><!-- HEAD_svelte-4dky5b_END -->
  </head>
  <body itemscope itemtype="https://schema.org/WebPage">
    <div style="display: contents">      <header id="header" class="fixed z-50 w-full transition-all duration-500 ease-in-out border-b-2 border-transparent max-h-[4.125rem] false"><div class="navbar"><div class="navbar-start">  <div class="dropdown lg:hidden"><label for="navbar-dropdown" tabindex="0" class="btn btn-square btn-ghost" data-svelte-h="svelte-rz1qrs"><span class="i-heroicons-outline-menu-alt-1"></span></label> <ul id="navbar-dropdown" tabindex="0" class="menu menu-compact dropdown-content bg-base-100 text-base-content shadow-lg rounded-box min-w-max max-w-52 p-2"><li><a href="/hello-world">Get Started</a> </li><li><a href="/hello-world/elements">Elements</a> </li></ul></div> <div class="swap order-last hidden lg:inline-grid"><button class="swap-on btn btn-ghost text-base font-normal normal-case transition-all duration-200 hidden"></button> <ul class="swap-off menu menu-horizontal p-0"><li><a class="!rounded-btn" href="/hello-world">Get Started</a> </li><li><a class="!rounded-btn" href="/hello-world/elements">Elements</a> </li></ul></div> <a href="/" class="btn btn-ghost normal-case text-lg">AkaniX3</a></div> <div class="navbar-end"> <div id="change-theme" class="dropdown dropdown-end">  <div tabindex="0" class="btn btn-square btn-ghost" data-svelte-h="svelte-1qtp8cz"><span class="i-heroicons-outline-color-swatch"></span></div>   <ul tabindex="0" class="flex flex-nowrap shadow-2xl menu dropdown-content bg-base-100 text-base-content rounded-box w-52 p-2 gap-2 overflow-y-auto max-h-[21.5rem]"><button data-theme="cmyk" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üåï Shiro</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="night" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üåë Kuro</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="cupcake" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üßÅ Cupcake</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="valentine" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üéÄ Valentine</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="synthwave" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üåÉ Synthwave</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="aqua" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">ü´ß Aqua</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="lofi" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üé∂ Lo-Fi</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="lemonade" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üçã Lemonade</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="garden" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üè° Garden</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="dracula" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üßõ Dark</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="retro" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üåá Retro</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button><button data-theme="black" class="btn btn-ghost w-full hover:bg-primary group rounded-lg flex bg-base-100 p-2 transition-all"><p class="flex-1 text-left text-base-content group-hover:text-primary-content transition-color">üñ§ Black</p> <div class="grid grid-cols-4 gap-0.5 m-auto"><div class="bg-primary w-1 h-4 rounded-btn"></div><div class="bg-secondary w-1 h-4 rounded-btn"></div><div class="bg-accent w-1 h-4 rounded-btn"></div><div class="bg-neutral w-1 h-4 rounded-btn"></div></div> </button></ul></div></div></div></header> <button id="totop" aria-label="scroll to top" class="fixed grid group btn btn-circle btn-lg border-none backdrop-blur bottom-6 right-6 z-50 duration-500 ease-in-out btn-ghost bg-base-100/30 md:bg-base-200/30 translate-y-24"> <div class="radial-progress text-accent transition-all duration-500 ease-in-out group-hover:text-[color-mix(in_oklab,oklch(var(--a)),black_7%)] col-start-1 row-start-1" style="--size:4rem; --thickness: 0.25rem; --value:undefined;"></div> <div class="border-4 border-base-content/10 group-hover:border-transparent col-start-1 row-start-1 rounded-full w-full h-full p-4 grid duration-500 ease-in-out" data-svelte-h="svelte-hwvjh5"><span class="i-heroicons-solid-chevron-up !w-6 !h-6"></span></div></button> <div class="bg-base-100 md:bg-base-200 min-h-screen pt-16 md:pb-8 lg:pb-16">  <div class="flex flex-col flex-nowrap justify-center xl:flex-row xl:flex-wrap"><div class="flex-1 w-full order-first ease-out transform mx-auto xl:mr-0 xl:ml-0"></div> <div class="flex-1 w-full xl:order-last ease-out transform mx-auto xl:ml-0 xl:mr-0"></div> <div class="flex-none w-full max-w-screen-md mx-auto xl:mx-0"><article itemscope itemtype="https://schema.org/BlogPosting" itemprop="blogPost" class="h-entry card bg-base-100 rounded-none md:rounded-box md:shadow-xl overflow-hidden z-10 md:mb-8 lg:mb-16">   <div class="card-body gap-0 "><div class="flex flex-col gap-2"><figure class="md:order-last rounded-box shadow-xl mb-4 flex-col gap-2 -mx-4 -mt-8 md:mt-0"><picture><source srcset="/_app/immutable/assets/akasec1.DXT4CD57.avif 736w" type="image/avif"> <img src="/blogs/akasec_CTF_2024/akasec1.png" alt="/blogs/akasec_CTF_2024/akasec1.png" class="u-featured" loading="lazy" decoding="async"></picture></figure> <div class="flex font-semibold gap-1.5"><a rel="author" class="opacity-75 hover:opacity-100 hover:text-primary duration-500 ease-in-out p-author h-card" href="https://urara-demo.netlify.app">AkaniX3</a> <span class="opacity-50" data-svelte-h="svelte-1edzios">/</span> <a href="/blogs/akasec_CTF_2024" class="u-url u-uid swap group/time"><time class="group-hover/time:opacity-0 font-semibold opacity-75 duration-500 ease-in-out mr-auto dt-published" datetime="2024-06-11T00:00:00.000Z" itemprop="datePublished">Tuesday, Jun 11, 24</time> <time class="opacity-0 group-hover/time:opacity-100 font-semibold text-primary duration-500 ease-in-out mr-auto dt-updated" datetime="2024-06-18T04:52:25.531Z" itemprop="dateModified">Tuesday, Jun 18, 24</time></a></div> <h1 itemprop="name headline" class="card-title text-3xl mb-8 p-name">Akasec CTF 2024 writeup</h1> </div> <main itemprop="articleBody" class="urara-prose prose e-content"><p data-svelte-h="svelte-47jd1v">My writeup on Akasec CTF on the challs solved by my team ‚ÄòBits &amp; Pieces‚Äô and we placed rank 13th on this ctf event, it was a pretty good run this time!</p> <h2 id="crypto" data-svelte-h="svelte-wa5cyn"><a href="#crypto">Crypto:</a></h2> <h3 id="lost" data-svelte-h="svelte-yqweog"><a href="#lost">Lost</a></h3> <p data-svelte-h="svelte-1c7kq8k">In the given code:</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> random </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> getrandbits</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> Crypto</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">Util</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">number </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> getPrime</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> bytes_to_long</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> SECRET </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> FLAG</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">e </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">2</span></div><div class='line'><span style="color: #EEFFFF">p </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">getPrime</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">256</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">q </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">getPrime</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">256</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">n </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> p </span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF"> q</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">m </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">bytes_to_long</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">FLAG</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">cor_m </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> m </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">getrandbits</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">160</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> __name__ </span><span style="color: #89DDFF">==</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">__main__</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    c </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">pow</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">m</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> e</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> n</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">n = &#123;&#125;</span><span style="color: #EEFFFF">&#92;n</span><span style="color: #C3E88D">c = &#123;&#125;</span><span style="color: #EEFFFF">&#92;n</span><span style="color: #C3E88D">cor_m = &#123;&#125;</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">format</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">n</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> c</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> cor_m</span><span style="color: #89DDFF">))</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-12gy2jx">We can identify that the <code>getrandbits(160)</code> is a small range and we can exploit this vulnerablility using the ‚ÄúCoppersmith‚Äôs Attack‚Äù which helps us to find the potential value to decrypt the flag.</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">m</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">724154397787031699242933363312913323086319394176220093419616667612889538090840511506381320998293481458429167685676367015744314015744</span></div><div class='line'><span style="color: #EEFFFF">n</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">5113166966960118603250666870544315753374750136060769465485822149528706374700934720443689630473991177661169179462100732951725871457633686010946951736764639</span></div><div class='line'><span style="color: #EEFFFF">e</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">2</span></div><div class='line'><span style="color: #EEFFFF">c</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">329402637167950119278220170950190680807120980712143610290182242567212843996710001488280098771626903975534140478814872389359418514658167263670496584963653</span></div><div class='line'><span style="color: #EEFFFF">P</span><span style="color: #89DDFF">.&lt;</span><span style="color: #EEFFFF">x</span><span style="color: #89DDFF">&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">PolynomialRing</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">Zmod</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">n</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">implementation</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">NTL</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">pol </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">m </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> x</span><span style="color: #89DDFF">)**</span><span style="color: #F78C6C">2</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF"> c</span></div><div class='line'><span style="color: #EEFFFF">roots </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> pol</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">small_roots</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">epsilon</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">/</span><span style="color: #F78C6C">50</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">Potential solutions:</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #89DDFF">for</span><span style="color: #EEFFFF"> root </span><span style="color: #89DDFF">in</span><span style="color: #EEFFFF"> roots</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">      a </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> root</span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF">m</span></div><div class='line'><span style="color: #EEFFFF">      </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">root</span><span style="color: #89DDFF">+</span><span style="color: #82AAFF">m</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-1gxiubc">Here the code attempts to find small roots of the polynomial using the small_roots method with an epsilon value of 1/50. The small_roots method is used to find roots of a polynomial where the roots are known to be small relative to the modulus n.</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">roots </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> pol</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">small_roots</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">epsilon</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">/</span><span style="color: #F78C6C">50</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-1rnkgep">Then we iterate through the found roots, add each root to m, and prints the result. The addition of m to each root is done because the polynomial was defined as (m+x), so the roots found are offsets from m.</p> <p data-svelte-h="svelte-101tood">The encryption operation for RSA with exponent e can be written as: c = (m+k)<sup>2</sup> mod n</p> <p data-svelte-h="svelte-lfn3ol">where k is some small value. The polynomial (m+x)<sup>2</sup> - c is constructed and the small roots method is used to find the possible values of k. By adding these roots back to m, the code attempts to recover the original plaintext m.</p> <p data-svelte-h="svelte-11jp7hr">Flag: <code>AKASEC{c0pp3r5m17h_4774ck_1n_1ov3_w17h_5m4ll_3xp0n3nts}</code></p> <h3 id="power-over-all" data-svelte-h="svelte-w9mjb8"><a href="#power-over-all">Power Over All</a></h3> <p data-svelte-h="svelte-9nci6w">meow</p> <h3 id="twin" data-svelte-h="svelte-oug0wg"><a href="#twin">Twin</a></h3> <p data-svelte-h="svelte-1c7kq8k">In the given code:</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> Crypto</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">Util</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">number </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> getPrime</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> bytes_to_long</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> long_to_bytes</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> SECRET </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> FLAG</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">e </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">5</span></div><div class='line'><span style="color: #EEFFFF">p </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">getPrime</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">256</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">q </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">getPrime</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">256</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">n </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> p </span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF"> q</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">m1 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">bytes_to_long</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">FLAG</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">m2 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> m1 </span><span style="color: #89DDFF">&gt;&gt;</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">8</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> __name__ </span><span style="color: #89DDFF">==</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">__main__</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">    c1</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> c2 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">pow</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">m1</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> e</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> n</span><span style="color: #89DDFF">),</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">pow</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">m2</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> e</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> n</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">n = &#123;&#125;</span><span style="color: #EEFFFF">&#92;n</span><span style="color: #C3E88D">c1 = &#123;&#125;</span><span style="color: #EEFFFF">&#92;n</span><span style="color: #C3E88D">c2 = &#123;&#125;</span><span style="color: #89DDFF">"</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">format</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">n</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> c1</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> c2</span><span style="color: #89DDFF">))</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-h1nrj4">We need to exploit a specific relationship between the plaintext messages encrypted as c1 and c2 under the same RSA modulus and small exponent e=5. To find the missing value of the encrypted flag, let‚Äôs say ‚Äòk‚Äô, It iterates over potential values of k, calculates the GCD of the resulting polynomials, and checks for non-trivial solutions that can be used to derive the plaintext.</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">e</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">5</span></div><div class='line'><span style="color: #EEFFFF">n</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">6689395968128828819066313568755352659933786163958960509093076953387786003094796620023245908431378798689402141767913187865481890531897380982752646248371131</span></div><div class='line'><span style="color: #EEFFFF">c1</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">3179086897466915481381271626207192941491642866779832228649829433228467288272857233211003674026630320370606056763863577418383068472502537763155844909495261</span></div><div class='line'><span style="color: #EEFFFF">c2</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">6092690907728422411002652306266695413630015459295863614266882891010434275671526748292477694364341702119123311030726985363936486558916833174742155473021704</span></div><div class='line'><span style="color: #EEFFFF">n1</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">n</span></div><div class='line'><span style="color: #EEFFFF">n2</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">n</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">my_gcd</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">a</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> b</span><span style="color: #89DDFF">):</span><span style="color: #EEFFFF"> </span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> a</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">monic</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> b </span><span style="color: #89DDFF">==</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">else</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">my_gcd</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">b</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> a </span><span style="color: #89DDFF">%</span><span style="color: #82AAFF"> b</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">R</span><span style="color: #89DDFF">.&lt;</span><span style="color: #EEFFFF">m2</span><span style="color: #89DDFF">&gt;=</span><span style="color: #82AAFF">Zmod</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">n</span><span style="color: #89DDFF">)[]</span></div><div class='line'><span style="color: #89DDFF">for</span><span style="color: #EEFFFF"> k </span><span style="color: #89DDFF">in</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">range</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">256</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">   f1</span><span style="color: #89DDFF">=(</span><span style="color: #EEFFFF">m2</span><span style="color: #89DDFF">*</span><span style="color: #F78C6C">256</span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF">k</span><span style="color: #89DDFF">)^</span><span style="color: #EEFFFF">e</span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">c1</span></div><div class='line'><span style="color: #EEFFFF">   f2</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">m2</span><span style="color: #89DDFF">^</span><span style="color: #EEFFFF">e</span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF">c2</span></div><div class='line'><span style="color: #EEFFFF">   </span><span style="color: #89DDFF">if</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">my_gcd</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">f1</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> f2</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">coefficients</span><span style="color: #89DDFF">()[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">!=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">):</span><span style="color: #EEFFFF"> </span><span style="color: #546E7A"># finds the potential</span></div><div class='line'><span style="color: #EEFFFF">        res </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">my_gcd</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">f1</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> f2</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">small_roots</span><span style="color: #89DDFF">()[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">256</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> k </span></div><div class='line'><span style="color: #EEFFFF">        </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">long_to_bytes</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">Integer</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">res</span><span style="color: #89DDFF">)))</span><span style="color: #EEFFFF"> </span><span style="color: #546E7A"># prints the flag</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-7a2ica">If the leading coefficient of the GCD is not 1, it indicates a potential value which was at iteration 125 which converts to the ascii value <code>}</code>. Then uses the small_roots method to find the potential message.</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">   </span><span style="color: #89DDFF">if</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">my_gcd</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">f1</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> f2</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">coefficients</span><span style="color: #89DDFF">()[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">!=</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">):</span><span style="color: #EEFFFF"> </span><span style="color: #546E7A"># finds the potential</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-17iupm2">The message is converted into a readable format, and prints it.</p> <p data-svelte-h="svelte-1cch9bp">Flag: <code>AKASEC{be_on_the_right_side_of_history_free_palestine}</code></p> <h3 id="my-calculus-lab" data-svelte-h="svelte-1excqrt"><a href="#my-calculus-lab">My Calculus Lab</a></h3> <p data-svelte-h="svelte-1c7kq8k">In the given code:</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> Crypto</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">Cipher </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> AES</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> Crypto</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">Util</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">Padding </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> pad</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> hashlib</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> sympy </span><span style="color: #89DDFF">as</span><span style="color: #EEFFFF"> sp</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> random</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">FLAG </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">b</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">REDACTED</span><span style="color: #89DDFF">'</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">key </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> random</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">getrandbits</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">7</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">x </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> sp</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">symbols</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">x</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">f </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">REDACTED</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">f_prime </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">REDACTED</span><span style="color: #89DDFF">"</span></div><div class='line'><span style="color: #EEFFFF">f_second_prime </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">"</span><span style="color: #C3E88D">REDACTED</span><span style="color: #89DDFF">"</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">assert</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF">f_second_prime </span><span style="color: #89DDFF">-</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF">f_prime </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">3</span><span style="color: #89DDFF">*</span><span style="color: #EEFFFF">f </span><span style="color: #89DDFF">==</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #89DDFF">assert</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">f</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">|</span><span style="color: #EEFFFF"> f_prime</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">==</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #C792EA">def</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">encrypt</span><span style="color: #89DDFF">(</span><span style="color: #EEFFFF">message</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> key</span><span style="color: #89DDFF">):</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">global</span><span style="color: #EEFFFF"> f</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #C792EA">global</span><span style="color: #EEFFFF"> x</span></div><div class='line'><span style="color: #EEFFFF">    point </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> f</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> key</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">evalf</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">100</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    point_hash </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hashlib</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">sha256</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">point</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">()).</span><span style="color: #82AAFF">digest</span><span style="color: #89DDFF">()[:</span><span style="color: #F78C6C">16</span><span style="color: #89DDFF">]</span></div><div class='line'><span style="color: #EEFFFF">    cipher </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> AES</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">point_hash</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> AES</span><span style="color: #89DDFF">.</span><span style="color: #F07178">MODE_CBC</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">    iv </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> cipher</span><span style="color: #89DDFF">.</span><span style="color: #F07178">iv</span></div><div class='line'><span style="color: #EEFFFF">    ciphertext </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> cipher</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">encrypt</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">pad</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">message</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> AES</span><span style="color: #89DDFF">.</span><span style="color: #F07178">block_size</span><span style="color: #89DDFF">))</span></div><div class='line'><span style="color: #EEFFFF">    </span><span style="color: #89DDFF">return</span><span style="color: #EEFFFF"> iv</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">hex</span><span style="color: #89DDFF">()</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">+</span><span style="color: #EEFFFF"> ciphertext</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">hex</span><span style="color: #89DDFF">()</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">encrypted </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">encrypt</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">FLAG</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> key</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"Key: </span><span style="color: #82AAFF">&#123;key&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #C792EA">f</span><span style="color: #C3E88D">"Encrypted: </span><span style="color: #82AAFF">&#123;encrypted&#125;</span><span style="color: #C3E88D">"</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-1rhwiyn">On observing the above code we can clearly see that:</p> <ul data-svelte-h="svelte-164us0m"><li>The function f satisfies a second-order linear differential equation: 2f‚Äù - 6f- + 3f = 0</li> <li>Encryption key is derived by evaluating function f at a key value (7-bits)</li> <li>This key is then hashed using SHA-256 to generate the AES key.</li></ul> <p data-svelte-h="svelte-j3428z">To decrypt the message, we need to just reverse the process, that‚Äôs to solve the differential equation with various initial conditions and regenerate the AES key.</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> Crypto</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">Cipher </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> AES</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> Crypto</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">Util</span><span style="color: #89DDFF">.</span><span style="color: #EEFFFF">Padding </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> pad</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF">unpad</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> hashlib</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> sympy </span><span style="color: #89DDFF">as</span><span style="color: #EEFFFF"> sp</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> random</span></div><div class='line'><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> math</span></div><div class='line'><span style="color: #89DDFF">from</span><span style="color: #EEFFFF"> sympy </span><span style="color: #89DDFF">import</span><span style="color: #EEFFFF"> symbols</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> Function</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> Eq</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> dsolve</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> exp</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> Derivative</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">x </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> sp</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">symbols</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">x</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">e</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">math</span><span style="color: #89DDFF">.</span><span style="color: #F07178">e</span></div><div class='line'><span style="color: #EEFFFF">Key</span><span style="color: #89DDFF">=</span><span style="color: #F78C6C">60</span></div><div class='line'><span style="color: #EEFFFF">Encrypted</span><span style="color: #89DDFF">=</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">805534c14e694348a67da0d75165623cf603c2a98405b34fe3ba8752ce24f5040c39873ec2150a61591b233490449b8b7bedaf83aa9d4b57d6469cd3f78fdf55</span><span style="color: #89DDFF">'</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">iv_hex</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">Encrypted</span><span style="color: #89DDFF">[:</span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">]</span></div><div class='line'><span style="color: #EEFFFF">ct</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">Encrypted</span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">32</span><span style="color: #89DDFF">:]</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">iv</span><span style="color: #89DDFF">=</span><span style="color: #FFCB6B">bytes</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">fromhex</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">iv_hex</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">c</span><span style="color: #89DDFF">=</span><span style="color: #FFCB6B">bytes</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">fromhex</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">ct</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">pos14</span><span style="color: #89DDFF">=[[</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">12</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">4</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">4</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">8</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">12</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">8</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">8</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">4</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">12</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">12</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">12</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">12</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">12</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">4</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">8</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">10</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">12</span><span style="color: #89DDFF">],</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">[</span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> </span><span style="color: #F78C6C">14</span><span style="color: #89DDFF">]]</span></div><div class='line'></div><div class='line'><span style="color: #EEFFFF">x </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">symbols</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">x</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">y </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">Function</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">y</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #546E7A"># Define the differential equation 2y''-6y'+3y=0</span></div><div class='line'><span style="color: #EEFFFF">differential_eq </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">Eq</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">*</span><span style="color: #82AAFF">y</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">diff</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> x</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">-</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">*</span><span style="color: #82AAFF">y</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">diff</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">+</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">3</span><span style="color: #89DDFF">*</span><span style="color: #82AAFF">y</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span></div><div class='line'></div><div class='line'><span style="color: #89DDFF">for</span><span style="color: #EEFFFF"> i </span><span style="color: #89DDFF">in</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">range</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">pos14</span><span style="color: #89DDFF">)):</span></div><div class='line'><span style="color: #EEFFFF">   </span><span style="color: #546E7A"># Define initial conditions y(0) = y0 and y'(0) = y1</span></div><div class='line'><span style="color: #EEFFFF">   y0 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> pos14</span><span style="color: #89DDFF">[</span><span style="color: #EEFFFF">i</span><span style="color: #89DDFF">][</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF">  </span><span style="color: #546E7A"># Ey(x)</span></div><div class='line'><span style="color: #EEFFFF">   y1 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> pos14</span><span style="color: #89DDFF">[</span><span style="color: #EEFFFF">i</span><span style="color: #89DDFF">][</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF">  </span><span style="color: #546E7A"># y'(x)</span></div><div class='line'><span style="color: #EEFFFF">   initial_conditions </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span><span style="color: #EEFFFF">y</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">):</span><span style="color: #EEFFFF"> y0</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> y</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">diff</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">):</span><span style="color: #EEFFFF"> y1</span><span style="color: #89DDFF">&#125;</span></div><div class='line'><span style="color: #EEFFFF">   </span><span style="color: #546E7A"># Solve the differential equation with initial conditions</span></div><div class='line'><span style="color: #EEFFFF">   solution </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">dsolve</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">differential_eq</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> y</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">ics</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">initial_conditions</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">   f</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">solution</span><span style="color: #89DDFF">.</span><span style="color: #F07178">rhs</span></div><div class='line'><span style="color: #EEFFFF">   point </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> f</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> Key</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">evalf</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">100</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">   point_hash </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hashlib</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">sha256</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">point</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">()).</span><span style="color: #82AAFF">digest</span><span style="color: #89DDFF">()[:</span><span style="color: #F78C6C">16</span><span style="color: #89DDFF">]</span></div><div class='line'><span style="color: #EEFFFF">   cipher </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> AES</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">point_hash</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> AES</span><span style="color: #89DDFF">.</span><span style="color: #F07178">MODE_CBC</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> iv</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">   flag </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> cipher</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">decrypt</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">c</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">   </span><span style="color: #89DDFF">if</span><span style="color: #EEFFFF"> </span><span style="color: #C792EA">b</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">AKASEC</span><span style="color: #89DDFF">'</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">in</span><span style="color: #EEFFFF"> flag</span><span style="color: #89DDFF">:</span></div><div class='line'><span style="color: #EEFFFF">       </span><span style="color: #82AAFF">print</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">flag</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-5apmfr">We first define the differential Equation</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">y </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">Function</span><span style="color: #89DDFF">(</span><span style="color: #89DDFF">'</span><span style="color: #C3E88D">y</span><span style="color: #89DDFF">'</span><span style="color: #89DDFF">)(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">differential_eq </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">Eq</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">2</span><span style="color: #89DDFF">*</span><span style="color: #82AAFF">y</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">diff</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> x</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">-</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">6</span><span style="color: #89DDFF">*</span><span style="color: #82AAFF">y</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">diff</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">)</span><span style="color: #82AAFF"> </span><span style="color: #89DDFF">+</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">3</span><span style="color: #89DDFF">*</span><span style="color: #82AAFF">y</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-hxtay4">Then iterate through all possible initial conditions, and every solution is evaluated and hashed at the key to derive the AES key.</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #89DDFF">for</span><span style="color: #EEFFFF"> i </span><span style="color: #89DDFF">in</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">range</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">len</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">pos14</span><span style="color: #89DDFF">)):</span></div><div class='line'><span style="color: #EEFFFF">   y0 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> pos14</span><span style="color: #89DDFF">[</span><span style="color: #EEFFFF">i</span><span style="color: #89DDFF">][</span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">]</span></div><div class='line'><span style="color: #EEFFFF">   y1 </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> pos14</span><span style="color: #89DDFF">[</span><span style="color: #EEFFFF">i</span><span style="color: #89DDFF">][</span><span style="color: #F78C6C">1</span><span style="color: #89DDFF">]</span></div><div class='line'><span style="color: #EEFFFF">   initial_conditions </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #89DDFF">&#123;</span><span style="color: #EEFFFF">y</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">):</span><span style="color: #EEFFFF"> y0</span><span style="color: #89DDFF">,</span><span style="color: #EEFFFF"> y</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">diff</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #F78C6C">0</span><span style="color: #89DDFF">):</span><span style="color: #EEFFFF"> y1</span><span style="color: #89DDFF">&#125;</span><span style="color: #EEFFFF"> </span></div><div class='line'><span style="color: #EEFFFF">   solution </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">dsolve</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">differential_eq</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> y</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> </span><span style="color: #EEFFFF">ics</span><span style="color: #89DDFF">=</span><span style="color: #82AAFF">initial_conditions</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #546E7A"># Solve Diff eq </span></div><div class='line'><span style="color: #EEFFFF">   f</span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF">solution</span><span style="color: #89DDFF">.</span><span style="color: #F07178">rhs</span></div><div class='line'><span style="color: #EEFFFF">   point </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> f</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">subs</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">x</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> Key</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">evalf</span><span style="color: #89DDFF">(</span><span style="color: #F78C6C">100</span><span style="color: #89DDFF">)</span><span style="color: #EEFFFF"> </span><span style="color: #546E7A">#evaluate</span></div><div class='line'><span style="color: #EEFFFF">   point_hash </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> hashlib</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">sha256</span><span style="color: #89DDFF">(</span><span style="color: #FFCB6B">str</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">point</span><span style="color: #89DDFF">).</span><span style="color: #82AAFF">encode</span><span style="color: #89DDFF">()).</span><span style="color: #82AAFF">digest</span><span style="color: #89DDFF">()[:</span><span style="color: #F78C6C">16</span><span style="color: #89DDFF">]</span><span style="color: #EEFFFF"> </span><span style="color: #546E7A">#hash</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-1rzz1y1">This regenerated AES derived key and IV is used to decrypt the cipher text.</p> <!-- HTML_TAG_START --><pre class="shiki material-default" style="background-color: #263238; color: #EEFFFF" py="true"><div class="language-id">py</div><div class='code-container'><code><div class='line'><span style="color: #EEFFFF">cipher </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> AES</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">new</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">point_hash</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> AES</span><span style="color: #89DDFF">.</span><span style="color: #F07178">MODE_CBC</span><span style="color: #89DDFF">,</span><span style="color: #82AAFF"> iv</span><span style="color: #89DDFF">)</span></div><div class='line'><span style="color: #EEFFFF">flag </span><span style="color: #89DDFF">=</span><span style="color: #EEFFFF"> </span><span style="color: #82AAFF">unpad</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">cipher</span><span style="color: #89DDFF">.</span><span style="color: #82AAFF">decrypt</span><span style="color: #89DDFF">(</span><span style="color: #82AAFF">c</span><span style="color: #89DDFF">),</span><span style="color: #82AAFF"> AES</span><span style="color: #89DDFF">.</span><span style="color: #F07178">block_size</span><span style="color: #89DDFF">)</span></div></code></div></pre><!-- HTML_TAG_END --> <p data-svelte-h="svelte-5tsqpy">Flag: <code>AKASEC{d1d_y0u_3nj0y_c41cu1u5_101?}</code></p> <p data-svelte-h="svelte-zii0yf">visit <a href="https://urara-docs.netlify.app" rel="nofollow noopener noreferrer external" target="_blank">urara-docs.netlify.app</a>.</p></main> <div class="divider mt-4 mb-0"></div> <div><a href="/?tags=CTF" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#CTF </a><a href="/?tags=Cryptography" class="btn btn-sm btn-ghost normal-case mt-2 mr-2 p-category">#Cryptography </a></div></div>  </article> <footer id="footer" class="footer footer-center bg-base-300 text-base-content shadow-inner p-8 md:rounded-box sticky bottom-0 z-0 md:static "><div class="prose"><p><a href="/atom.xml" rel="noopener noreferrer external" target="_blank">Feed</a> <span class="mr-1" data-svelte-h="svelte-1qx196n">¬∑</span><a href="/sitemap.xml" rel="noopener noreferrer external" target="_blank">Sitemap</a>  <br>
      Copyright ¬© 2024 AkaniX3 <br>
      Powered by
      <a rel="noopener noreferrer external" target="_blank" class="tooltip tooltip-secondary hover:text-secondary" data-tip="üå∏ [Œ¥] - Based on MDsveX & SvelteKit üå∏" href="https://github.com/importantimport/urara" data-svelte-h="svelte-urea7w">Urara</a> </p></div></footer></div></div></div> 
			<script type="application/json" data-sveltekit-fetched data-url="/posts.json">{"status":200,"statusText":"","headers":{},"body":"[{\"title\":\"VSCTF 2024 writeup\",\"image\":\"/blogs/vs_CTF_2024/vsctf.png\",\"alt\":\"VSCTF\",\"created\":\"2024-6-15\",\"tags\":[\"CTF\",\"Reverse Engineer\",\"Miscellaneous\"],\"updated\":\"2024-06-18T04:52:25.531Z\",\"images\":[],\"slug\":\"/blogs/vs_CTF_2024/+page.svelte.md\",\"path\":\"/blogs/vs_CTF_2024\",\"toc\":[{\"depth\":2,\"title\":\"Reverse:\",\"slug\":\"reverse\"},{\"depth\":3,\"title\":\"intro-reversing\",\"slug\":\"intro-reversing\"},{\"depth\":3,\"title\":\"awa-jelly\",\"slug\":\"awa-jelly\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Akasec CTF 2024 writeup\",\"image\":\"/blogs/akasec_CTF_2024/akasec1.png\",\"alt\":\"AkasecCTF\",\"created\":\"2024-6-11\",\"tags\":[\"CTF\",\"Cryptography\"],\"updated\":\"2024-06-18T04:52:25.531Z\",\"images\":[],\"slug\":\"/blogs/akasec_CTF_2024/+page.svelte.md\",\"path\":\"/blogs/akasec_CTF_2024\",\"toc\":[{\"depth\":2,\"title\":\"Crypto:\",\"slug\":\"crypto\"},{\"depth\":3,\"title\":\"Lost\",\"slug\":\"lost\"},{\"depth\":3,\"title\":\"Power Over All\",\"slug\":\"power-over-all\"},{\"depth\":3,\"title\":\"Twin\",\"slug\":\"twin\"},{\"depth\":3,\"title\":\"My Calculus Lab\",\"slug\":\"my-calculus-lab\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"Elements\",\"created\":\"2021-12-12T00:00:00.000Z\",\"tags\":[\"Urara\",\"Elements\"],\"updated\":\"2024-06-18T04:52:25.535Z\",\"images\":[],\"slug\":\"/hello-world/elements/+page.svelte.md\",\"path\":\"/hello-world/elements\",\"toc\":[{\"depth\":2,\"title\":\"Headings\",\"slug\":\"headings\"},{\"depth\":3,\"title\":\"Heading\",\"slug\":\"heading\"},{\"depth\":4,\"title\":\"Heading\",\"slug\":\"heading-1\"},{\"depth\":5,\"title\":\"Heading\",\"slug\":\"heading-2\"},{\"depth\":6,\"title\":\"Heading\",\"slug\":\"heading-3\"},{\"depth\":2,\"title\":\"Paragraphs\",\"slug\":\"paragraphs\"},{\"depth\":2,\"title\":\"Lists\",\"slug\":\"lists\"},{\"depth\":3,\"title\":\"Definition List (dl)\",\"slug\":\"definition-list-dl\"},{\"depth\":3,\"title\":\"Ordered List (ol)\",\"slug\":\"ordered-list-ol\"},{\"depth\":3,\"title\":\"Unordered List (ul)\",\"slug\":\"unordered-list-ul\"},{\"depth\":3,\"title\":\"Checkbox List (ul)\",\"slug\":\"checkbox-list-ul\"},{\"depth\":2,\"title\":\"Table\",\"slug\":\"table\"},{\"depth\":2,\"title\":\"Footnotes\",\"slug\":\"footnotes\"},{\"depth\":2,\"title\":\"Code\",\"slug\":\"code\"},{\"depth\":2,\"title\":\"Misc\",\"slug\":\"misc\"},{\"depth\":2,\"title\":\"Svelte Components\",\"slug\":\"svelte-components\"}],\"type\":\"article\",\"html\":\"\"},{\"title\":\"ToC Disabled\",\"summary\":\"This post has disabled table of contents.\",\"created\":\"2021-12-12T00:00:00.000Z\",\"tags\":[\"Front-Matter\"],\"toc\":false,\"updated\":\"2024-06-18T04:52:25.535Z\",\"images\":[],\"slug\":\"/hello-world/toc-disabled/+page.md\",\"path\":\"/hello-world/toc-disabled\",\"type\":\"article\",\"html\":\"\"},{\"title\":\"Hello World\",\"image\":\"/hello-world/urara.webp\",\"alt\":\"Urara\",\"created\":\"2021-11-01T00:00:00.000Z\",\"updated\":\"2021-12-12T00:00:00.000Z\",\"tags\":[\"Hello World\",\"Urara\"],\"images\":[],\"slug\":\"/hello-world/+page.svelte.md\",\"path\":\"/hello-world\",\"toc\":[{\"depth\":2,\"title\":\"Developing\",\"slug\":\"developing\"},{\"depth\":2,\"title\":\"Building\",\"slug\":\"building\"},{\"depth\":2,\"title\":\"Documentation\",\"slug\":\"documentation\"}],\"type\":\"article\",\"html\":\"\"}]"}</script>
			<script>
				{
					__sveltekit_karda6 = {
						base: new URL("../..", location).pathname.slice(0, -1)
					};

					const element = document.currentScript.parentElement;

					const data = [null,null];

					Promise.all([
						import("../../_app/immutable/entry/start.vDsreik-.js"),
						import("../../_app/immutable/entry/app.6eKRZCuF.js")
					]).then(([kit, app]) => {
						kit.start(app, element, {
							node_ids: [0, 3],
							data,
							form: null,
							error: null
						});
					});
				}
			</script>
		</div>
  </body>
</html>
